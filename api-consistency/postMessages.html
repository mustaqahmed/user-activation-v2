<!DOCTYPE html>
<!--
  The cross-origin part of this demo is here:
  https://eirage.github.io/user-activation-v2/api-consistency/postMessages-sub.html
-->
<html>
<head>
  <title>User Activation v2 with postMessages</title>
  <link rel="stylesheet" href="styles.css">
  <script src="common.js"></script>
  <script src="api-selector.js"></script>
  <script>
    function init() {
      apiSelector.setup();

      window.addEventListener("message", (e) => {
        log("received: " + e.data, "yellow");
        if (e.data === "call_test_api")
          apiSelector.callAndLog();
      });
    }
  </script>
</head>
<body onload="init()">
  <div class="instruction">
    <p><b>Steps:</b>&ensp;
      (a) Select an API to test.&ensp;
      (b) Reload the page using the address bar button.&ensp;
      (c) Click the button in the subframe to pick which message requests the test API.
    </p>
    <p><b>Expectation:</b> Any those buttons should successsfully call the test API.
      User Activation v2 works in each case.</p>
  </div>

  <p>
    <label>User-activation-gated API to test:</label>
    <select id="test-api">
    </select>
  </p>

  <div class="api_target" id="test-api-target"></div>

  <h1>Top frame in mustaqahmed.github.io</h1>

  <iframe id="iframe" src="https://eirage.github.io/user-activation-v2/api-consistency/postMessages-sub.html"></iframe>

  <div id="log"><b>Log:</b> </div>
</body>
</html>
